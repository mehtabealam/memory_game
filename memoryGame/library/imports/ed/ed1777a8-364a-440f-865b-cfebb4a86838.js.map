{"version":3,"sources":["assets/scripts/laoding/Loading.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\nimport { GameManager } from \"../managers/GameManager\";\nimport { NetworkManager } from \"../managers/NetworkManager\";\nimport { API_END_POINTS, REQUEST_TYPE } from \"../managers/NetworkConfig\";\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Loading extends cc.Component {\n\n\n   start(){\n    NetworkManager.getInstance().init();\n    if(!cc.sys.localStorage.getItem(\"hasLaunchedBeforev2\")){\n        cc.sys.localStorage.clear();\n          cc.sys.localStorage.setItem(\"hasLaunchedBeforev2\", true)\n      }\n  \n  \n      if (!cc.sys.localStorage.getItem(\"Language\")) {\n        cc.sys.localStorage.setItem(\"Language\", \"ES\");\n      }  \n  \n      if(!cc.sys.localStorage.getItem(\"hasTermAccepted\")){\n        cc.sys.localStorage.setItem(\"hasTermAccepted\", false);\n      }\n  \n  \n      if(!cc.sys.localStorage.getItem(\"lastPlayedLevel\")){\n        cc.sys.localStorage.setItem(\"lastPlayedLevel\", 0);\n      }\n  \n  \n      if(!cc.sys.localStorage.getItem(\"hint\")){\n        cc.sys.localStorage.setItem(\"hint\", 3);\n      }\n\n\n      if(!cc.sys.localStorage.getItem(\"clue\")){\n        cc.sys.localStorage.setItem(\"clue\", 3);\n      }\n\n      if(!cc.sys.localStorage.getItem(\"lastTenSeconds\")){\n        cc.sys.localStorage.setItem(\"lastTenSeconds\", false);\n      }\n\n\n      if(!cc.sys.localStorage.getItem(\"rewardClaimDate\")){\n        cc.sys.localStorage.setItem(\"rewardClaimDate\", new Date(98,1,1).toDateString());\n      }\n\n      cc.debug.setDisplayStats(false);\n      \n\n      console.log(\"isonline\", cc.sys.getNetworkType());\n      if (cc.sys.getNetworkType() == cc.sys.NetworkType.LAN || cc.sys.getNetworkType() == cc.sys.NetworkType.WWAN) {\n        NetworkManager.getInstance().sendRequest(API_END_POINTS.GET_TIME, \n          REQUEST_TYPE.GET, {},\n          (data, error) => {\n            if(data) {\n              let parseData = JSON.parse(data);\n              let date = parseData.currentDateTime;\n              let day = date.split(\"T\")[0];\n              GameManager.getInstance().setCurrentDate(day);\n            }\n            console.log(\"isonline data\", data);\n            this.startLoading();\n          },\n          (error, data) =>{\n            console.log(\"isonline error\", error, data);\n            GameManager.getInstance().setCurrentDate( cc.sys.localStorage.getItem(\"rewardClaimDate\"));\n            this.startLoading();\n          },true);\n      }else{\n        console.log(\"new network saving local time\");\n        GameManager.getInstance().setCurrentDate( cc.sys.localStorage.getItem(\"rewardClaimDate\"));\n        this.startLoading();\n      }\n    \n     \n   }\n\n   startLoading(){\n    GameManager.getInstance().loadGameConfig()\n    .then(()=>  GameManager.getInstance().loadLevels())\n    .then(()=> GameManager.getInstance().loadLanaguge())\n    .then(()=>{\n      GameManager.getInstance().changeCurrentLanguage();\n      return GameManager.getInstance().loadLevelImages(JSON.parse(cc.sys.localStorage.getItem(\"lastPlayedLevel\")));\n    })\n    .then(() => {console.log(\"Data has been loaded\")\n      cc.director.loadScene('home');\n    })\n    .catch((error)=> console.error(\"Error while loading resources\", error));\n   }\n\n\n   \n}\n"]}