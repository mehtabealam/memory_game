!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(global,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=58)}([function(e,t){e.exports=require("path")},function(e,t,n){var r,o,i=n(5),s=n(22),c=n(24),a=n(25),l=n(10);"function"==typeof Symbol&&"function"==typeof Symbol.for?(r=Symbol.for("graceful-fs.queue"),o=Symbol.for("graceful-fs.previous")):(r="___graceful-fs.queue",o="___graceful-fs.previous");var u=function(){};if(l.debuglog?u=l.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(u=function(){var e=l.format.apply(l,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),!global[r]){var f=[];Object.defineProperty(global,r,{get:function(){return f}}),i.close=function(e){function t(t,n){return e.call(i,t,(function(e){e||y(),"function"==typeof n&&n.apply(this,arguments)}))}return Object.defineProperty(t,o,{value:e}),t}(i.close),i.closeSync=function(e){function t(t){e.apply(i,arguments),y()}return Object.defineProperty(t,o,{value:e}),t}(i.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",(function(){u(global[r]),n(15).equal(global[r].length,0)}))}function d(e){s(e),e.gracefulify=d,e.createReadStream=function(t,n){return new e.ReadStream(t,n)},e.createWriteStream=function(t,n){return new e.WriteStream(t,n)};var t=e.readFile;e.readFile=function(e,n,r){"function"==typeof n&&(r=n,n=null);return function e(n,r,o){return t(n,r,(function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?("function"==typeof o&&o.apply(this,arguments),y()):p([e,[n,r,o]])}))}(e,n,r)};var n=e.writeFile;e.writeFile=function(e,t,r,o){"function"==typeof r&&(o=r,r=null);return function e(t,r,o,i){return n(t,r,o,(function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?("function"==typeof i&&i.apply(this,arguments),y()):p([e,[t,r,o,i]])}))}(e,t,r,o)};var r=e.appendFile;r&&(e.appendFile=function(e,t,n,o){"function"==typeof n&&(o=n,n=null);return function e(t,n,o,i){return r(t,n,o,(function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?("function"==typeof i&&i.apply(this,arguments),y()):p([e,[t,n,o,i]])}))}(e,t,n,o)});var o=e.readdir;function i(t){return o.apply(e,t)}if(e.readdir=function(e,t,n){var r=[e];"function"!=typeof t?r.push(t):n=t;return r.push((function(e,t){t&&t.sort&&t.sort();!e||"EMFILE"!==e.code&&"ENFILE"!==e.code?("function"==typeof n&&n.apply(this,arguments),y()):p([i,[r]])})),i(r)},"v0.8"===process.version.substr(0,4)){var a=c(e);f=a.ReadStream,h=a.WriteStream}var l=e.ReadStream;l&&(f.prototype=Object.create(l.prototype),f.prototype.open=function(){var e=this;S(e.path,e.flags,e.mode,(function(t,n){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n),e.read())}))});var u=e.WriteStream;function f(e,t){return this instanceof f?(l.apply(this,arguments),this):f.apply(Object.create(f.prototype),arguments)}function h(e,t){return this instanceof h?(u.apply(this,arguments),this):h.apply(Object.create(h.prototype),arguments)}u&&(h.prototype=Object.create(u.prototype),h.prototype.open=function(){var e=this;S(e.path,e.flags,e.mode,(function(t,n){t?(e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n))}))}),Object.defineProperty(e,"ReadStream",{get:function(){return f},set:function(e){f=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FileReadStream",{get:function(){return f},set:function(e){f=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FileWriteStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0});var m=e.open;function S(e,t,n,r){return"function"==typeof n&&(r=n,n=null),function e(t,n,r,o){return m(t,n,r,(function(i,s){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?("function"==typeof o&&o.apply(this,arguments),y()):p([e,[t,n,r,o]])}))}(e,t,n,r)}return e.open=S,e}function p(e){u("ENQUEUE",e[0].name,e[1]),global[r].push(e)}function y(){var e=global[r].shift();e&&(u("RETRY",e[0].name,e[1]),e[0].apply(null,e[1]))}e.exports=d(a(i)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!i.__patched&&(e.exports=d(i),i.__patched=!0)},function(e,t,n){"use strict";t.fromCallback=function(e){return Object.defineProperty((function(){if("function"!=typeof arguments[arguments.length-1])return new Promise((t,n)=>{arguments[arguments.length]=(e,r)=>{if(e)return n(e);t(r)},arguments.length++,e.apply(this,arguments)});e.apply(this,arguments)}),"name",{value:e.name})},t.fromPromise=function(e){return Object.defineProperty((function(){const t=arguments[arguments.length-1];if("function"!=typeof t)return e.apply(this,arguments);e.apply(this,arguments).then(e=>t(null,e),t)}),"name",{value:e.name})}},function(e,t,n){"use strict";const r=(0,n(2).fromCallback)(n(27)),o=n(28);e.exports={mkdirs:r,mkdirsSync:o,mkdirp:r,mkdirpSync:o,ensureDir:r,ensureDirSync:o}},function(e,t,n){"use strict";const r=n(2).fromPromise,o=n(14);e.exports={pathExists:r((function(e){return o.access(e).then(()=>!0).catch(()=>!1)})),pathExistsSync:o.existsSync}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("stream")},function(e,t,n){"use strict";const r=n(1),o=n(0),i=10,s=5,c=0,a=process.versions.node.split("."),l=Number.parseInt(a[0],10),u=Number.parseInt(a[1],10),f=Number.parseInt(a[2],10);function d(){if(l>i)return!0;if(l===i){if(u>s)return!0;if(u===s&&f>=c)return!0}return!1}function p(e,t){const n=o.resolve(e).split(o.sep).filter(e=>e),r=o.resolve(t).split(o.sep).filter(e=>e);return n.reduce((e,t,n)=>e&&r[n]===t,!0)}function y(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}e.exports={checkPaths:function(e,t,n,o){!function(e,t,n){d()?r.stat(e,{bigint:!0},(e,o)=>{if(e)return n(e);r.stat(t,{bigint:!0},(e,t)=>e?"ENOENT"===e.code?n(null,{srcStat:o,destStat:null}):n(e):n(null,{srcStat:o,destStat:t}))}):r.stat(e,(e,o)=>{if(e)return n(e);r.stat(t,(e,t)=>e?"ENOENT"===e.code?n(null,{srcStat:o,destStat:null}):n(e):n(null,{srcStat:o,destStat:t}))})}(e,t,(r,i)=>{if(r)return o(r);const{srcStat:s,destStat:c}=i;return c&&c.ino&&c.dev&&c.ino===s.ino&&c.dev===s.dev?o(new Error("Source and destination must not be the same.")):s.isDirectory()&&p(e,t)?o(new Error(y(e,t,n))):o(null,{srcStat:s,destStat:c})})},checkPathsSync:function(e,t,n){const{srcStat:o,destStat:i}=function(e,t){let n,o;n=d()?r.statSync(e,{bigint:!0}):r.statSync(e);try{o=d()?r.statSync(t,{bigint:!0}):r.statSync(t)}catch(e){if("ENOENT"===e.code)return{srcStat:n,destStat:null};throw e}return{srcStat:n,destStat:o}}(e,t);if(i&&i.ino&&i.dev&&i.ino===o.ino&&i.dev===o.dev)throw new Error("Source and destination must not be the same.");if(o.isDirectory()&&p(e,t))throw new Error(y(e,t,n));return{srcStat:o,destStat:i}},checkParentPaths:function e(t,n,i,s,c){const a=o.resolve(o.dirname(t)),l=o.resolve(o.dirname(i));if(l===a||l===o.parse(l).root)return c();d()?r.stat(l,{bigint:!0},(r,o)=>r?"ENOENT"===r.code?c():c(r):o.ino&&o.dev&&o.ino===n.ino&&o.dev===n.dev?c(new Error(y(t,i,s))):e(t,n,l,s,c)):r.stat(l,(r,o)=>r?"ENOENT"===r.code?c():c(r):o.ino&&o.dev&&o.ino===n.ino&&o.dev===n.dev?c(new Error(y(t,i,s))):e(t,n,l,s,c))},checkParentPathsSync:function e(t,n,i,s){const c=o.resolve(o.dirname(t)),a=o.resolve(o.dirname(i));if(a===c||a===o.parse(a).root)return;let l;try{l=d()?r.statSync(a,{bigint:!0}):r.statSync(a)}catch(e){if("ENOENT"===e.code)return;throw e}if(l.ino&&l.dev&&l.ino===n.ino&&l.dev===n.dev)throw new Error(y(t,i,s));return e(t,n,a,s)},isSrcSubdir:p}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(32);e.exports={remove:r(o),removeSync:o.sync}},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("util")},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(40);e.exports={readJson:r(o.readFile),readJsonSync:o.readFileSync,writeJson:r(o.writeFile),writeJsonSync:o.writeFileSync}},function(e,t){e.exports=require("http")},function(e,t,n){"use strict";e.exports=Object.assign({},n(14),n(16),n(19),n(31),n(33),n(39),n(3),n(43),n(45),n(47),n(4),n(8));const r=n(5);Object.getOwnPropertyDescriptor(r,"promises")&&Object.defineProperty(e.exports,"promises",{get:()=>r.promises})},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(1),i=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","lchmod","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>"function"==typeof o[e]);Object.keys(o).forEach(e=>{"promises"!==e&&(t[e]=o[e])}),i.forEach(e=>{t[e]=r(o[e])}),t.exists=function(e,t){return"function"==typeof t?o.exists(e,t):new Promise(t=>o.exists(e,t))},t.read=function(e,t,n,r,i,s){return"function"==typeof s?o.read(e,t,n,r,i,s):new Promise((s,c)=>{o.read(e,t,n,r,i,(e,t,n)=>{if(e)return c(e);s({bytesRead:t,buffer:n})})})},t.write=function(e,t,...n){return"function"==typeof n[n.length-1]?o.write(e,t,...n):new Promise((r,i)=>{o.write(e,t,...n,(e,t,n)=>{if(e)return i(e);r({bytesWritten:t,buffer:n})})})},"function"==typeof o.realpath.native&&(t.realpath.native=r(o.realpath.native))},function(e,t){e.exports=require("assert")},function(e,t,n){"use strict";e.exports={copySync:n(26)}},function(e,t,n){"use strict";const r=n(0);function o(e){return(e=r.normalize(r.resolve(e)).split(r.sep)).length>0?e[0]:null}const i=/[<>:"|?*]/;e.exports={getRootPath:o,invalidWin32Path:function(e){const t=o(e);return e=e.replace(t,""),i.test(e)}}},function(e,t,n){"use strict";const r=n(1),o=n(9),i=n(0);e.exports={hasMillisRes:function(e){let t=i.join("millis-test"+Date.now().toString()+Math.random().toString().slice(2));t=i.join(o.tmpdir(),t);const n=new Date(1435410243862);r.writeFile(t,"https://github.com/jprichardson/node-fs-extra/pull/141",o=>{if(o)return e(o);r.open(t,"r+",(o,i)=>{if(o)return e(o);r.futimes(i,n,n,n=>{if(n)return e(n);r.close(i,n=>{if(n)return e(n);r.stat(t,(t,n)=>{if(t)return e(t);e(null,n.mtime>1435410243e3)})})})})})},hasMillisResSync:function(){let e=i.join("millis-test-sync"+Date.now().toString()+Math.random().toString().slice(2));e=i.join(o.tmpdir(),e);const t=new Date(1435410243862);r.writeFileSync(e,"https://github.com/jprichardson/node-fs-extra/pull/141");const n=r.openSync(e,"r+");return r.futimesSync(n,t,t),r.closeSync(n),r.statSync(e).mtime>1435410243e3},timeRemoveMillis:function(e){if("number"==typeof e)return 1e3*Math.floor(e/1e3);if(e instanceof Date)return new Date(1e3*Math.floor(e.getTime()/1e3));throw new Error("fs-extra: timeRemoveMillis() unknown parameter type")},utimesMillis:function(e,t,n,o){r.open(e,"r+",(e,i)=>{if(e)return o(e);r.futimes(i,t,n,e=>{r.close(i,t=>{o&&o(e||t)})})})},utimesMillisSync:function(e,t,n){const o=r.openSync(e,"r+");return r.futimesSync(o,t,n),r.closeSync(o)}}},function(e,t,n){"use strict";const r=n(2).fromCallback;e.exports={copy:r(n(30))}},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("electron")},function(e,t,n){var r=n(23),o=process.cwd,i=null,s=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return i||(i=o.call(process)),i};try{process.cwd()}catch(e){}var c=process.chdir;process.chdir=function(e){i=null,c.call(process,e)},e.exports=function(e){r.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(e){e.lchmod=function(t,n,o){e.open(t,r.O_WRONLY|r.O_SYMLINK,n,(function(t,r){t?o&&o(t):e.fchmod(r,n,(function(t){e.close(r,(function(e){o&&o(t||e)}))}))}))},e.lchmodSync=function(t,n){var o,i=e.openSync(t,r.O_WRONLY|r.O_SYMLINK,n),s=!0;try{o=e.fchmodSync(i,n),s=!1}finally{if(s)try{e.closeSync(i)}catch(e){}else e.closeSync(i)}return o}}(e);e.lutimes||function(e){r.hasOwnProperty("O_SYMLINK")?(e.lutimes=function(t,n,o,i){e.open(t,r.O_SYMLINK,(function(t,r){t?i&&i(t):e.futimes(r,n,o,(function(t){e.close(r,(function(e){i&&i(t||e)}))}))}))},e.lutimesSync=function(t,n,o){var i,s=e.openSync(t,r.O_SYMLINK),c=!0;try{i=e.futimesSync(s,n,o),c=!1}finally{if(c)try{e.closeSync(s)}catch(e){}else e.closeSync(s)}return i}):(e.lutimes=function(e,t,n,r){r&&process.nextTick(r)},e.lutimesSync=function(){})}(e);e.chown=i(e.chown),e.fchown=i(e.fchown),e.lchown=i(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=c(e.chownSync),e.fchownSync=c(e.fchownSync),e.lchownSync=c(e.lchownSync),e.chmodSync=o(e.chmodSync),e.fchmodSync=o(e.fchmodSync),e.lchmodSync=o(e.lchmodSync),e.stat=a(e.stat),e.fstat=a(e.fstat),e.lstat=a(e.lstat),e.statSync=l(e.statSync),e.fstatSync=l(e.fstatSync),e.lstatSync=l(e.lstatSync),e.lchmod||(e.lchmod=function(e,t,n){n&&process.nextTick(n)},e.lchmodSync=function(){});e.lchown||(e.lchown=function(e,t,n,r){r&&process.nextTick(r)},e.lchownSync=function(){});"win32"===s&&(e.rename=(t=e.rename,function(n,r,o){var i=Date.now(),s=0;t(n,r,(function c(a){if(a&&("EACCES"===a.code||"EPERM"===a.code)&&Date.now()-i<6e4)return setTimeout((function(){e.stat(r,(function(e,i){e&&"ENOENT"===e.code?t(n,r,c):o(a)}))}),s),void(s<100&&(s+=10));o&&o(a)}))}));var t;function n(t){return t?function(n,r,o){return t.call(e,n,r,(function(e){u(e)&&(e=null),o&&o.apply(this,arguments)}))}:t}function o(t){return t?function(n,r){try{return t.call(e,n,r)}catch(e){if(!u(e))throw e}}:t}function i(t){return t?function(n,r,o,i){return t.call(e,n,r,o,(function(e){u(e)&&(e=null),i&&i.apply(this,arguments)}))}:t}function c(t){return t?function(n,r,o){try{return t.call(e,n,r,o)}catch(e){if(!u(e))throw e}}:t}function a(t){return t?function(n,r,o){function i(e,t){t&&(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296)),o&&o.apply(this,arguments)}return"function"==typeof r&&(o=r,r=null),r?t.call(e,n,r,i):t.call(e,n,i)}:t}function l(t){return t?function(n,r){var o=r?t.call(e,n,r):t.call(e,n);return o.uid<0&&(o.uid+=4294967296),o.gid<0&&(o.gid+=4294967296),o}:t}function u(e){return!e||("ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code))}e.read=function(t){function n(n,r,o,i,s,c){var a;if(c&&"function"==typeof c){var l=0;a=function(u,f,d){if(u&&"EAGAIN"===u.code&&l<10)return l++,t.call(e,n,r,o,i,s,a);c.apply(this,arguments)}}return t.call(e,n,r,o,i,s,a)}return n.__proto__=t,n}(e.read),e.readSync=(f=e.readSync,function(t,n,r,o,i){for(var s=0;;)try{return f.call(e,t,n,r,o,i)}catch(e){if("EAGAIN"===e.code&&s<10){s++;continue}throw e}});var f}},function(e,t){e.exports=require("constants")},function(e,t,n){var r=n(6).Stream;e.exports=function(e){return{ReadStream:function t(n,o){if(!(this instanceof t))return new t(n,o);r.call(this);var i=this;this.path=n;this.fd=null;this.readable=!0;this.paused=!1;this.flags="r";this.mode=438;this.bufferSize=65536;o=o||{};var s=Object.keys(o);for(var c=0,a=s.length;c<a;c++){var l=s[c];this[l]=o[l]}this.encoding&&this.setEncoding(this.encoding);if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick((function(){i._read()}));e.open(this.path,this.flags,this.mode,(function(e,t){if(e)return i.emit("error",e),void(i.readable=!1);i.fd=t,i.emit("open",t),i._read()}))},WriteStream:function t(n,o){if(!(this instanceof t))return new t(n,o);r.call(this);this.path=n;this.fd=null;this.writable=!0;this.flags="w";this.encoding="binary";this.mode=438;this.bytesWritten=0;o=o||{};var i=Object.keys(o);for(var s=0,c=i.length;s<c;s++){var a=i[s];this[a]=o[a]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1;this._queue=[];null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}},function(e,t,n){"use strict";e.exports=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var t={__proto__:e.__proto__};else t=Object.create(null);return Object.getOwnPropertyNames(e).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(3).mkdirsSync,s=n(18).utimesMillisSync,c=n(7);function a(e,t,n,i){if(!i.filter||i.filter(t,n))return function(e,t,n,i){const s=(i.dereference?r.statSync:r.lstatSync)(t);if(s.isDirectory())return function(e,t,n,o,i){if(!t)return function(e,t,n,o){return r.mkdirSync(n),u(t,n,o),r.chmodSync(n,e.mode)}(e,n,o,i);if(t&&!t.isDirectory())throw new Error(`Cannot overwrite non-directory '${o}' with directory '${n}'.`);return u(n,o,i)}(s,e,t,n,i);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return function(e,t,n,o,i){return t?function(e,t,n,o){if(o.overwrite)return r.unlinkSync(n),l(e,t,n,o);if(o.errorOnExist)throw new Error(`'${n}' already exists`)}(e,n,o,i):l(e,n,o,i)}(s,e,t,n,i);if(s.isSymbolicLink())return function(e,t,n,i){let s=r.readlinkSync(t);i.dereference&&(s=o.resolve(process.cwd(),s));if(e){let e;try{e=r.readlinkSync(n)}catch(e){if("EINVAL"===e.code||"UNKNOWN"===e.code)return r.symlinkSync(s,n);throw e}if(i.dereference&&(e=o.resolve(process.cwd(),e)),c.isSrcSubdir(s,e))throw new Error(`Cannot copy '${s}' to a subdirectory of itself, '${e}'.`);if(r.statSync(n).isDirectory()&&c.isSrcSubdir(e,s))throw new Error(`Cannot overwrite '${e}' with '${s}'.`);return function(e,t){return r.unlinkSync(t),r.symlinkSync(e,t)}(s,n)}return r.symlinkSync(s,n)}(e,t,n,i)}(e,t,n,i)}function l(e,t,o,i){return"function"==typeof r.copyFileSync?(r.copyFileSync(t,o),r.chmodSync(o,e.mode),i.preserveTimestamps?s(o,e.atime,e.mtime):void 0):function(e,t,o,i){const s=n(29)(65536),c=r.openSync(t,"r"),a=r.openSync(o,"w",e.mode);let l=0;for(;l<e.size;){const e=r.readSync(c,s,0,65536,l);r.writeSync(a,s,0,e),l+=e}i.preserveTimestamps&&r.futimesSync(a,e.atime,e.mtime);r.closeSync(c),r.closeSync(a)}(e,t,o,i)}function u(e,t,n){r.readdirSync(e).forEach(r=>(function(e,t,n,r){const i=o.join(t,e),s=o.join(n,e),{destStat:l}=c.checkPathsSync(i,s,"copy");return a(l,i,s,r)})(r,e,t,n))}e.exports=function(e,t,n){"function"==typeof n&&(n={filter:n}),(n=n||{}).clobber=!("clobber"in n)||!!n.clobber,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269");const{srcStat:s,destStat:l}=c.checkPathsSync(e,t,"copy");return c.checkParentPathsSync(e,s,t,"copy"),function(e,t,n,s){if(s.filter&&!s.filter(t,n))return;const c=o.dirname(n);r.existsSync(c)||i(c);return a(e,t,n,s)}(l,e,t,n)}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(17).invalidWin32Path,s=parseInt("0777",8);e.exports=function e(t,n,c,a){if("function"==typeof n?(c=n,n={}):n&&"object"==typeof n||(n={mode:n}),"win32"===process.platform&&i(t)){const e=new Error(t+" contains invalid WIN32 path characters.");return e.code="EINVAL",c(e)}let l=n.mode;const u=n.fs||r;void 0===l&&(l=s&~process.umask()),a||(a=null),c=c||function(){},t=o.resolve(t),u.mkdir(t,l,r=>{if(!r)return c(null,a=a||t);switch(r.code){case"ENOENT":if(o.dirname(t)===t)return c(r);e(o.dirname(t),n,(r,o)=>{r?c(r,o):e(t,n,c,o)});break;default:u.stat(t,(e,t)=>{e||!t.isDirectory()?c(r,a):c(null,a)})}})}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(17).invalidWin32Path,s=parseInt("0777",8);e.exports=function e(t,n,c){n&&"object"==typeof n||(n={mode:n});let a=n.mode;const l=n.fs||r;if("win32"===process.platform&&i(t)){const e=new Error(t+" contains invalid WIN32 path characters.");throw e.code="EINVAL",e}void 0===a&&(a=s&~process.umask()),c||(c=null),t=o.resolve(t);try{l.mkdirSync(t,a),c=c||t}catch(r){if("ENOENT"===r.code){if(o.dirname(t)===t)throw r;c=e(o.dirname(t),n,c),e(t,n,c)}else{let e;try{e=l.statSync(t)}catch(e){throw r}if(!e.isDirectory())throw r}}return c}},function(e,t,n){"use strict";e.exports=function(e){if("function"==typeof Buffer.allocUnsafe)try{return Buffer.allocUnsafe(e)}catch(t){return new Buffer(e)}return new Buffer(e)}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(3).mkdirs,s=n(4).pathExists,c=n(18).utimesMillis,a=n(7);function l(e,t,n,r,c){const a=o.dirname(n);s(a,(o,s)=>o?c(o):s?f(e,t,n,r,c):void i(a,o=>o?c(o):f(e,t,n,r,c)))}function u(e,t,n,r,o,i){Promise.resolve(o.filter(n,r)).then(s=>s?e(t,n,r,o,i):i(),e=>i(e))}function f(e,t,n,r,o){return r.filter?u(d,e,t,n,r,o):d(e,t,n,r,o)}function d(e,t,n,o,i){(o.dereference?r.stat:r.lstat)(t,(s,c)=>s?i(s):c.isDirectory()?function(e,t,n,o,i,s){if(!t)return function(e,t,n,o,i){r.mkdir(n,s=>{if(s)return i(s);h(t,n,o,t=>t?i(t):r.chmod(n,e.mode,i))})}(e,n,o,i,s);if(t&&!t.isDirectory())return s(new Error(`Cannot overwrite non-directory '${o}' with directory '${n}'.`));return h(n,o,i,s)}(c,e,t,n,o,i):c.isFile()||c.isCharacterDevice()||c.isBlockDevice()?function(e,t,n,o,i,s){return t?function(e,t,n,o,i){if(!o.overwrite)return o.errorOnExist?i(new Error(`'${n}' already exists`)):i();r.unlink(n,r=>r?i(r):p(e,t,n,o,i))}(e,n,o,i,s):p(e,n,o,i,s)}(c,e,t,n,o,i):c.isSymbolicLink()?S(e,t,n,o,i):void 0)}function p(e,t,n,o,i){return"function"==typeof r.copyFile?r.copyFile(t,n,t=>t?i(t):y(e,n,o,i)):function(e,t,n,o,i){const s=r.createReadStream(t);s.on("error",e=>i(e)).once("open",()=>{const t=r.createWriteStream(n,{mode:e.mode});t.on("error",e=>i(e)).on("open",()=>s.pipe(t)).once("close",()=>y(e,n,o,i))})}(e,t,n,o,i)}function y(e,t,n,o){r.chmod(t,e.mode,r=>r?o(r):n.preserveTimestamps?c(t,e.atime,e.mtime,o):o())}function h(e,t,n,o){r.readdir(e,(r,i)=>r?o(r):m(i,e,t,n,o))}function m(e,t,n,r,i){const s=e.pop();return s?function(e,t,n,r,i,s){const c=o.join(n,t),l=o.join(r,t);a.checkPaths(c,l,"copy",(t,o)=>{if(t)return s(t);const{destStat:a}=o;f(a,c,l,i,t=>t?s(t):m(e,n,r,i,s))})}(e,s,t,n,r,i):i()}function S(e,t,n,i,s){r.readlink(t,(t,c)=>t?s(t):(i.dereference&&(c=o.resolve(process.cwd(),c)),e?void r.readlink(n,(t,l)=>t?"EINVAL"===t.code||"UNKNOWN"===t.code?r.symlink(c,n,s):s(t):(i.dereference&&(l=o.resolve(process.cwd(),l)),a.isSrcSubdir(c,l)?s(new Error(`Cannot copy '${c}' to a subdirectory of itself, '${l}'.`)):e.isDirectory()&&a.isSrcSubdir(l,c)?s(new Error(`Cannot overwrite '${l}' with '${c}'.`)):function(e,t,n){r.unlink(t,o=>o?n(o):r.symlink(e,t,n))}(c,n,s))):r.symlink(c,n,s)))}e.exports=function(e,t,n,r){"function"!=typeof n||r?"function"==typeof n&&(n={filter:n}):(r=n,n={}),r=r||function(){},(n=n||{}).clobber=!("clobber"in n)||!!n.clobber,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269"),a.checkPaths(e,t,"copy",(o,i)=>{if(o)return r(o);const{srcStat:s,destStat:c}=i;a.checkParentPaths(e,s,t,"copy",o=>o?r(o):n.filter?u(l,c,e,t,n,r):l(c,e,t,n,r))})}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(1),i=n(0),s=n(3),c=n(8),a=r((function(e,t){t=t||function(){},o.readdir(e,(n,r)=>{if(n)return s.mkdirs(e,t);r=r.map(t=>i.join(e,t)),function e(){const n=r.pop();if(!n)return t();c.remove(n,n=>{if(n)return t(n);e()})}()})}));function l(e){let t;try{t=o.readdirSync(e)}catch(t){return s.mkdirsSync(e)}t.forEach(t=>{t=i.join(e,t),c.removeSync(t)})}e.exports={emptyDirSync:l,emptydirSync:l,emptyDir:a,emptydir:a}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(15),s="win32"===process.platform;function c(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(t=>{e[t]=e[t]||r[t],e[t+="Sync"]=e[t]||r[t]}),e.maxBusyTries=e.maxBusyTries||3}function a(e,t,n){let r=0;"function"==typeof t&&(n=t,t={}),i(e,"rimraf: missing path"),i.strictEqual(typeof e,"string","rimraf: path should be a string"),i.strictEqual(typeof n,"function","rimraf: callback function required"),i(t,"rimraf: invalid options argument provided"),i.strictEqual(typeof t,"object","rimraf: options should be object"),c(t),l(e,t,(function o(i){if(i){if(("EBUSY"===i.code||"ENOTEMPTY"===i.code||"EPERM"===i.code)&&r<t.maxBusyTries){return r++,setTimeout(()=>l(e,t,o),100*r)}"ENOENT"===i.code&&(i=null)}n(i)}))}function l(e,t,n){i(e),i(t),i("function"==typeof n),t.lstat(e,(r,o)=>r&&"ENOENT"===r.code?n(null):r&&"EPERM"===r.code&&s?u(e,t,r,n):o&&o.isDirectory()?d(e,t,r,n):void t.unlink(e,r=>{if(r){if("ENOENT"===r.code)return n(null);if("EPERM"===r.code)return s?u(e,t,r,n):d(e,t,r,n);if("EISDIR"===r.code)return d(e,t,r,n)}return n(r)}))}function u(e,t,n,r){i(e),i(t),i("function"==typeof r),n&&i(n instanceof Error),t.chmod(e,438,o=>{o?r("ENOENT"===o.code?null:n):t.stat(e,(o,i)=>{o?r("ENOENT"===o.code?null:n):i.isDirectory()?d(e,t,n,r):t.unlink(e,r)})})}function f(e,t,n){let r;i(e),i(t),n&&i(n instanceof Error);try{t.chmodSync(e,438)}catch(e){if("ENOENT"===e.code)return;throw n}try{r=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw n}r.isDirectory()?y(e,t,n):t.unlinkSync(e)}function d(e,t,n,r){i(e),i(t),n&&i(n instanceof Error),i("function"==typeof r),t.rmdir(e,s=>{!s||"ENOTEMPTY"!==s.code&&"EEXIST"!==s.code&&"EPERM"!==s.code?s&&"ENOTDIR"===s.code?r(n):r(s):function(e,t,n){i(e),i(t),i("function"==typeof n),t.readdir(e,(r,i)=>{if(r)return n(r);let s,c=i.length;if(0===c)return t.rmdir(e,n);i.forEach(r=>{a(o.join(e,r),t,r=>{if(!s)return r?n(s=r):void(0==--c&&t.rmdir(e,n))})})})}(e,t,r)})}function p(e,t){let n;c(t=t||{}),i(e,"rimraf: missing path"),i.strictEqual(typeof e,"string","rimraf: path should be a string"),i(t,"rimraf: missing options"),i.strictEqual(typeof t,"object","rimraf: options should be object");try{n=t.lstatSync(e)}catch(n){if("ENOENT"===n.code)return;"EPERM"===n.code&&s&&f(e,t,n)}try{n&&n.isDirectory()?y(e,t,null):t.unlinkSync(e)}catch(n){if("ENOENT"===n.code)return;if("EPERM"===n.code)return s?f(e,t,n):y(e,t,n);if("EISDIR"!==n.code)throw n;y(e,t,n)}}function y(e,t,n){i(e),i(t),n&&i(n instanceof Error);try{t.rmdirSync(e)}catch(r){if("ENOTDIR"===r.code)throw n;if("ENOTEMPTY"===r.code||"EEXIST"===r.code||"EPERM"===r.code)!function(e,t){if(i(e),i(t),t.readdirSync(e).forEach(n=>p(o.join(e,n),t)),!s){return t.rmdirSync(e,t)}{const n=Date.now();do{try{return t.rmdirSync(e,t)}catch(e){}}while(Date.now()-n<500)}}(e,t);else if("ENOENT"!==r.code)throw r}}e.exports=a,a.sync=p},function(e,t,n){"use strict";const r=n(34),o=n(35),i=n(36);e.exports={createFile:r.createFile,createFileSync:r.createFileSync,ensureFile:r.createFile,ensureFileSync:r.createFileSync,createLink:o.createLink,createLinkSync:o.createLinkSync,ensureLink:o.createLink,ensureLinkSync:o.createLinkSync,createSymlink:i.createSymlink,createSymlinkSync:i.createSymlinkSync,ensureSymlink:i.createSymlink,ensureSymlinkSync:i.createSymlinkSync}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(0),i=n(1),s=n(3),c=n(4).pathExists;e.exports={createFile:r((function(e,t){function n(){i.writeFile(e,"",e=>{if(e)return t(e);t()})}i.stat(e,(r,i)=>{if(!r&&i.isFile())return t();const a=o.dirname(e);c(a,(e,r)=>e?t(e):r?n():void s.mkdirs(a,e=>{if(e)return t(e);n()}))})})),createFileSync:function(e){let t;try{t=i.statSync(e)}catch(e){}if(t&&t.isFile())return;const n=o.dirname(e);i.existsSync(n)||s.mkdirsSync(n),i.writeFileSync(e,"")}}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(0),i=n(1),s=n(3),c=n(4).pathExists;e.exports={createLink:r((function(e,t,n){function r(e,t){i.link(e,t,e=>{if(e)return n(e);n(null)})}c(t,(a,l)=>a?n(a):l?n(null):void i.lstat(e,i=>{if(i)return i.message=i.message.replace("lstat","ensureLink"),n(i);const a=o.dirname(t);c(a,(o,i)=>o?n(o):i?r(e,t):void s.mkdirs(a,o=>{if(o)return n(o);r(e,t)}))}))})),createLinkSync:function(e,t){if(i.existsSync(t))return;try{i.lstatSync(e)}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}const n=o.dirname(t);return i.existsSync(n)?i.linkSync(e,t):(s.mkdirsSync(n),i.linkSync(e,t))}}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(0),i=n(1),s=n(3),c=s.mkdirs,a=s.mkdirsSync,l=n(37),u=l.symlinkPaths,f=l.symlinkPathsSync,d=n(38),p=d.symlinkType,y=d.symlinkTypeSync,h=n(4).pathExists;e.exports={createSymlink:r((function(e,t,n,r){r="function"==typeof n?n:r,n="function"!=typeof n&&n,h(t,(s,a)=>s?r(s):a?r(null):void u(e,t,(s,a)=>{if(s)return r(s);e=a.toDst,p(a.toCwd,n,(n,s)=>{if(n)return r(n);const a=o.dirname(t);h(a,(n,o)=>n?r(n):o?i.symlink(e,t,s,r):void c(a,n=>{if(n)return r(n);i.symlink(e,t,s,r)}))})}))})),createSymlinkSync:function(e,t,n){if(i.existsSync(t))return;const r=f(e,t);e=r.toDst,n=y(r.toCwd,n);const s=o.dirname(t);return i.existsSync(s)?i.symlinkSync(e,t,n):(a(s),i.symlinkSync(e,t,n))}}},function(e,t,n){"use strict";const r=n(0),o=n(1),i=n(4).pathExists;e.exports={symlinkPaths:function(e,t,n){if(r.isAbsolute(e))return o.lstat(e,t=>t?(t.message=t.message.replace("lstat","ensureSymlink"),n(t)):n(null,{toCwd:e,toDst:e}));{const s=r.dirname(t),c=r.join(s,e);return i(c,(t,i)=>t?n(t):i?n(null,{toCwd:c,toDst:e}):o.lstat(e,t=>t?(t.message=t.message.replace("lstat","ensureSymlink"),n(t)):n(null,{toCwd:e,toDst:r.relative(s,e)})))}},symlinkPathsSync:function(e,t){let n;if(r.isAbsolute(e)){if(!(n=o.existsSync(e)))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}{const i=r.dirname(t),s=r.join(i,e);if(n=o.existsSync(s))return{toCwd:s,toDst:e};if(!(n=o.existsSync(e)))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:r.relative(i,e)}}}}},function(e,t,n){"use strict";const r=n(1);e.exports={symlinkType:function(e,t,n){if(n="function"==typeof t?t:n,t="function"!=typeof t&&t)return n(null,t);r.lstat(e,(e,r)=>{if(e)return n(null,"file");t=r&&r.isDirectory()?"dir":"file",n(null,t)})},symlinkTypeSync:function(e,t){let n;if(t)return t;try{n=r.lstatSync(e)}catch(e){return"file"}return n&&n.isDirectory()?"dir":"file"}}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(11);o.outputJson=r(n(41)),o.outputJsonSync=n(42),o.outputJSON=o.outputJson,o.outputJSONSync=o.outputJsonSync,o.writeJSON=o.writeJson,o.writeJSONSync=o.writeJsonSync,o.readJSON=o.readJson,o.readJSONSync=o.readJsonSync,e.exports=o},function(e,t,n){var r;try{r=n(1)}catch(e){r=n(5)}function o(e,t){var n,r="\n";return"object"==typeof t&&null!==t&&(t.spaces&&(n=t.spaces),t.EOL&&(r=t.EOL)),JSON.stringify(e,t?t.replacer:null,n).replace(/\n/g,r)+r}function i(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e=e.replace(/^\uFEFF/,"")}var s={readFile:function(e,t,n){null==n&&(n=t,t={}),"string"==typeof t&&(t={encoding:t});var o=(t=t||{}).fs||r,s=!0;"throws"in t&&(s=t.throws),o.readFile(e,t,(function(r,o){if(r)return n(r);var c;o=i(o);try{c=JSON.parse(o,t?t.reviver:null)}catch(t){return s?(t.message=e+": "+t.message,n(t)):n(null,null)}n(null,c)}))},readFileSync:function(e,t){"string"==typeof(t=t||{})&&(t={encoding:t});var n=t.fs||r,o=!0;"throws"in t&&(o=t.throws);try{var s=n.readFileSync(e,t);return s=i(s),JSON.parse(s,t.reviver)}catch(t){if(o)throw t.message=e+": "+t.message,t;return null}},writeFile:function(e,t,n,i){null==i&&(i=n,n={});var s=(n=n||{}).fs||r,c="";try{c=o(t,n)}catch(e){return void(i&&i(e,null))}s.writeFile(e,c,n,i)},writeFileSync:function(e,t,n){var i=(n=n||{}).fs||r,s=o(t,n);return i.writeFileSync(e,s,n)}};e.exports=s},function(e,t,n){"use strict";const r=n(0),o=n(3),i=n(4).pathExists,s=n(11);e.exports=function(e,t,n,c){"function"==typeof n&&(c=n,n={});const a=r.dirname(e);i(a,(r,i)=>r?c(r):i?s.writeJson(e,t,n,c):void o.mkdirs(a,r=>{if(r)return c(r);s.writeJson(e,t,n,c)}))}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(3),s=n(11);e.exports=function(e,t,n){const c=o.dirname(e);r.existsSync(c)||i.mkdirsSync(c),s.writeJsonSync(e,t,n)}},function(e,t,n){"use strict";e.exports={moveSync:n(44)}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(16).copySync,s=n(8).removeSync,c=n(3).mkdirpSync,a=n(7);function l(e,t,n){try{r.renameSync(e,t)}catch(r){if("EXDEV"!==r.code)throw r;return function(e,t,n){return i(e,t,{overwrite:n,errorOnExist:true}),s(e)}(e,t,n)}}e.exports=function(e,t,n){const i=(n=n||{}).overwrite||n.clobber||!1,{srcStat:u}=a.checkPathsSync(e,t,"move");return a.checkParentPathsSync(e,u,t,"move"),c(o.dirname(t)),function(e,t,n){if(n)return s(t),l(e,t,n);if(r.existsSync(t))throw new Error("dest already exists.");return l(e,t,n)}(e,t,i)}},function(e,t,n){"use strict";const r=n(2).fromCallback;e.exports={move:r(n(46))}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(19).copy,s=n(8).remove,c=n(3).mkdirp,a=n(4).pathExists,l=n(7);function u(e,t,n,o){r.rename(e,t,r=>r?"EXDEV"!==r.code?o(r):function(e,t,n,r){i(e,t,{overwrite:n,errorOnExist:!0},t=>t?r(t):s(e,r))}(e,t,n,o):o())}e.exports=function(e,t,n,r){"function"==typeof n&&(r=n,n={});const i=n.overwrite||n.clobber||!1;l.checkPaths(e,t,"move",(n,f)=>{if(n)return r(n);const{srcStat:d}=f;l.checkParentPaths(e,d,t,"move",n=>{if(n)return r(n);c(o.dirname(t),n=>n?r(n):function(e,t,n,r){if(n)return s(t,o=>o?r(o):u(e,t,n,r));a(t,(o,i)=>o?r(o):i?r(new Error("dest already exists.")):u(e,t,n,r))}(e,t,i,r))})})}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(1),i=n(0),s=n(3),c=n(4).pathExists;e.exports={outputFile:r((function(e,t,n,r){"function"==typeof n&&(r=n,n="utf8");const a=i.dirname(e);c(a,(i,c)=>i?r(i):c?o.writeFile(e,t,n,r):void s.mkdirs(a,i=>{if(i)return r(i);o.writeFile(e,t,n,r)}))})),outputFileSync:function(e,...t){const n=i.dirname(e);if(o.existsSync(n))return o.writeFileSync(e,...t);s.mkdirsSync(n),o.writeFileSync(e,...t)}}},function(e,t,n){const r=n(9),o=n(0),i=n(5),s=n(13),c=n(12),a=n(49),l=n(55),u=n(57);let f=null,d=null;class p{static checkPython(e){let t=l.getInstance(),n="check python";if(t.query(n))return;const r={tag:n};t.exec(["python","--version"],r,{stdout:e=>{},stderr:e=>{},exit:(t,n)=>{n&&n.includes("Python 2.7")?e("success"):e("failed","Python 2.7 is not installed")},error:(t,n,r)=>{e("failed","Python 2.7 is not installed")}})}static installerInstalled(){const e=o.join(r.homedir(),".sdkbox","bin","sdkbox");let t=null;try{t=i.statSync(e)}catch(e){t=null}return!!t&&t.isFile()}static needUpdate(){const e=o.join(r.homedir(),".sdkbox","creator","data","info.json");try{const t=i.readFileSync(e),n=JSON.parse(t);return n.version.installer.local!=n.version.installer.remote||n.version.gui.local!=n.version.gui.remote}catch(e){return!0}}static loadVersions(){p.loadLocalInstallerVersion(),p.loadLocalGUIVersion(),p.loadRemoteInstallerVersion(),p.loadRemoteGUIVersion()}static loadRemoteVersions(){p.loadRemoteInstallerVersion(),p.loadRemoteGUIVersion()}static loadLocalInstallerVersion(){const e=l.getInstance(),t="sdkbox version";if(e.query(t))return;const n=[p.getInstallerPath(),"--local","--jsonapi","version"],r={tag:t};e.exec(n,r,{stdout:e=>{try{const t={version:{installer:{local:JSON.parse(e).version}}};p.mergeAndSaveVersions(t)}catch(e){console.log("loadLocalInstallerVersion:"+e)}},stderr:e=>{},exit:(e,t)=>{},error:(e,t,n)=>{}})}static loadRemoteInstallerVersion(){const e=`${p.getDownloadHost()}installer/v1/manifest.json`;p.getJson(e,(e,t)=>{if(t)console.log(t);else if(e){const t={version:{installer:{remote:Object.keys(e.packages.SDKBOX.versions)[0]}}};p.mergeAndSaveVersions(t)}})}static loadLocalGUIVersion(){const e=o.join(r.homedir(),".sdkbox","creator","app","package.json");s.readJson(e).then(e=>{const t={version:{gui:{local:e.version}}};p.mergeAndSaveVersions(t)}).catch(e=>{})}static loadRemoteGUIVersion(){const e=`${p.getDownloadHost()}gui/creator/version`;p.getJson(e,(e,t)=>{if(t)console.log(t);else if(e){const t={version:{gui:{remote:e.version}}};p.mergeAndSaveVersions(t)}})}static mergeAndSaveVersions(e,t){let n=o.join(r.homedir(),".sdkbox","creator","data","info.json");t&&(n=t),s.pathExists(n).then(t=>{if(t)s.readJson(n).then(t=>{const r=JSON.stringify(u(t,e));p.saveToFile(n,r)}).catch(e=>{console.error(e)});else{const t=JSON.stringify(e);p.saveToFile(n,t)}}).catch(e=>{console.log(e)})}static installInstaller(e){let t=l.getInstance(),n="install sdkbox";if(t.query(n))return;const r={tag:n};t.exec(["python","-c","import urllib; s = urllib.urlopen('https://raw.githubusercontent.com/sdkbox-doc/en/master/install/install.py').read(); exec s"],r,{stdout:t=>{e("loading")},stderr:e=>{},exit:(t,n)=>{e("success")},error:(t,n,r)=>{e("failed","install SDKBox Installer failed")}})}static installInstallerIf(e){installerInstalled()||installInstaller(e)}static updateInstaller(e){let t=l.getInstance(),n="sdkbox version";if(t.query(n))return;const r=[p.getInstallerPath(),"--alwaysupdate","--nohelp","version"],o={tag:n};t.exec(r,o,{stdout:t=>{e("loading")},stderr:e=>{},exit:(t,n)=>{e("success")},error:(t,n,r)=>{e("failed","update SDKBox Installer failed")}})}static getInstallerPath(){let e=o.join(r.homedir(),".sdkbox","bin","sdkbox");return"win32"==r.platform()&&(e+=".bat"),p.fileExist(e)?e:null}static getSdkboxPluginsPath(e){const t=o.join(r.homedir(),".sdkbox","plugins");return e?o.join(t,e):t}static updateGUIMod(e,t,n){const i=o.join(r.homedir(),".sdkbox","temp",t);p.downloadFile(e,i,(e,t)=>{if(t)n("failed",t);else{const e=o.join(r.homedir(),".sdkbox","temp");let t=null;a.open(i,{lazyEntries:!0,decodeStrings:!1},(function(i,c){i?n("failed",i):(c.readEntry(),c.on("error",(function(e){t=e})),c.on("entry",(function(n){const r=n.fileName.toString("utf8");/\/$/.test(n.fileName)?s.ensureDir(o.join(e,r),e=>{e?t=e:c.readEntry()}):c.openReadStream(n,(function(n,i){n?t=n:(i.on("end",(function(){c.readEntry()})),i.pipe(s.createWriteStream(o.join(e,r))))}))})),c.on("end",(function(){if(t)n("failed",t);else{const t=o.join(r.homedir(),".sdkbox","creator","app");s.move(o.join(e,"sdkbox","app"),t,{overwrite:!0}).then(()=>s.move(o.join(e,"sdkbox","package.json"),o.join(r.homedir(),".sdkbox","creator","app","package.json"),{overwrite:!0})).then(()=>{n("success")}).catch(e=>{n("failed",e.message)})}})))}))}})}static downloadFile(e,t,n,r=1){s.remove(t).then(()=>s.ensureDir(o.dirname(t))).then(()=>{let o=s.createWriteStream(t);o.on("open",()=>{c.get(e,e=>{const{statusCode:i}=e;e.headers["content-type"];302==i&&r<4&&e.headers.location?p.downloadFile(e.headers.location,t,n,r+1):200===i?(e.pipe(o),e.on("end",()=>{o.close(),n(t,null)})):n(null,`status code:${i}`)}).on("error",e=>{console.log(e),i.unlink(t),n(null,e.message)})}),o.on("error",e=>{console.log(e)})}).catch(e=>{n(null,e.message)})}static saveToFile(e,t){const n=o.dirname(e);s.ensureDir(n).then(()=>{i.writeFileSync(e,t)})}static fileExist(e){let t;try{t=i.statSync(e)}catch(e){t=null}return!!t&&t.isFile()}static getJson(e,t){c.get(e,e=>{const{statusCode:n}=e;e.headers["content-type"];if(200!==n)return void t(null,`status code:${n}`);e.setEncoding("utf8");let r="";e.on("data",e=>{r+=e}),e.on("end",()=>{try{const e=JSON.parse(r);t(e,null)}catch(e){t(null,e.message)}})}).on("error",e=>{t(null,e.message)})}static compareVersions(e,t){if(null==e&&null==t)return 0;if(null==e)return-1;if(null==t)return 1;let n=e.replace(/^v/,"").split("."),r=t.replace(/^v/,"").split("."),o=Math.min(n.length,r.length);for(let e=0;e<o;e++){let t=parseInt(n[e]||0,10),o=parseInt(r[e]||0,10);if(t>o)return 1;if(o>t)return-1}if(n.length>o)for(let e=o;e<n.length;e++){if(0!=parseInt(n[e]||0,10))return 1}if(r.length>o)for(let e=o;e<r.length;e++){if(0!=parseInt(r[e]||0,10))return-1}return 0}static readJsonFromFile(e){try{const t=i.readFileSync(e);if(t)return JSON.parse(t)}catch(e){}return null}static writeJsonToFile(e,t){i.writeFileSync(e,JSON.stringify(t,0,4))}static getProjectRoot(){return null==f&&Editor.Project&&Editor.Project.path&&(f=Editor.Project.path),null==f&&Editor.projectInfo&&Editor.projectInfo.path&&(f=Editor.projectInfo.path),f}static getDownloadHost(){if(d)return d;const e="http://download.sdkbox.com/",t="http://sdkbox.anysdk.com/",n=o.join(r.homedir(),".sdkbox","conf","loc.json"),i=s.readJsonSync(n,{throws:!1});return i&&i.countryCode?d="CN"==i.countryCode?t:e:(setTimeout((function(){p.getJson("http://ip-api.com/json/",(r,o)=>{if(o)console.log(o);else if(r){d="CN"==r.countryCode?t:e;const o={countryCode:r.countryCode};p.mergeAndSaveVersions(o,n)}})}),100),e)}}e.exports=p},function(e,t,n){var r=n(5),o=n(50),i=n(51),s=n(53),c=n(10),a=n(20).EventEmitter,l=n(6).Transform,u=n(6).PassThrough,f=n(6).Writable;function d(e,t,n){"function"==typeof t&&(n=t,t=null),null==t&&(t={}),null==t.autoClose&&(t.autoClose=!1),null==t.lazyEntries&&(t.lazyEntries=!1),null==t.decodeStrings&&(t.decodeStrings=!0),null==t.validateEntrySizes&&(t.validateEntrySizes=!0),null==t.strictFileNames&&(t.strictFileNames=!1),null==n&&(n=I),r.fstat(e,(function(r,o){if(r)return n(r);p(i.createFromFd(e,{autoClose:!0}),o.size,t,n)}))}function p(e,t,n,r){"function"==typeof n&&(r=n,n=null),null==n&&(n={}),null==n.autoClose&&(n.autoClose=!0),null==n.lazyEntries&&(n.lazyEntries=!1),null==n.decodeStrings&&(n.decodeStrings=!0);var o=!!n.decodeStrings;if(null==n.validateEntrySizes&&(n.validateEntrySizes=!0),null==n.strictFileNames&&(n.strictFileNames=!1),null==r&&(r=I),"number"!=typeof t)throw new Error("expected totalSize parameter to be a number");if(t>Number.MAX_SAFE_INTEGER)throw new Error("zip file too large. only file sizes up to 2^52 are supported due to JavaScript's Number type being an IEEE 754 double.");e.ref();var i=Math.min(65557,t),s=k(i),c=t-s.length;w(e,s,0,i,c,(function(a){if(a)return r(a);for(var l=i-22;l>=0;l-=1)if(101010256===s.readUInt32LE(l)){var u=s.slice(l),f=u.readUInt16LE(4);if(0!==f)return r(new Error("multi-disk zip files are not supported: found disk number: "+f));var d=u.readUInt16LE(10),p=u.readUInt32LE(16),h=u.readUInt16LE(20),m=u.length-22;if(h!==m)return r(new Error("invalid comment length. expected: "+m+". found: "+h));var S=o?O(u,22,u.length,!1):u.slice(22);if(65535!==d&&4294967295!==p)return r(null,new y(e,p,t,d,S,n.autoClose,n.lazyEntries,o,n.validateEntrySizes,n.strictFileNames));var g=k(20),E=c+l-g.length;return void w(e,g,0,g.length,E,(function(i){if(i)return r(i);if(117853008!==g.readUInt32LE(0))return r(new Error("invalid zip64 end of central directory locator signature"));var s=N(g,8),c=k(56);w(e,c,0,c.length,s,(function(i){return i?r(i):101075792!==c.readUInt32LE(0)?r(new Error("invalid zip64 end of central directory record signature")):(d=N(c,32),p=N(c,48),r(null,new y(e,p,t,d,S,n.autoClose,n.lazyEntries,o,n.validateEntrySizes,n.strictFileNames)))}))}))}r(new Error("end of central directory record signature not found"))}))}function y(e,t,n,r,o,i,s,c,l,u){var f=this;a.call(f),f.reader=e,f.reader.on("error",(function(e){m(f,e)})),f.reader.once("close",(function(){f.emit("close")})),f.readEntryCursor=t,f.fileSize=n,f.entryCount=r,f.comment=o,f.entriesRead=0,f.autoClose=!!i,f.lazyEntries=!!s,f.decodeStrings=!!c,f.validateEntrySizes=!!l,f.strictFileNames=!!u,f.isOpen=!0,f.emittedError=!1,f.lazyEntries||f._readEntry()}function h(e,t){e.autoClose&&e.close(),m(e,t)}function m(e,t){e.emittedError||(e.emittedError=!0,e.emit("error",t))}function S(){}function g(e,t){return new Date(1980+(e>>9&127),(e>>5&15)-1,31&e,t>>11&31,t>>5&63,2*(31&t),0)}function E(e){return-1!==e.indexOf("\\")?"invalid characters in fileName: "+e:/^[a-zA-Z]:/.test(e)||/^\//.test(e)?"absolute path: "+e:-1!==e.split("/").indexOf("..")?"invalid relative path: "+e:null}function w(e,t,n,r,o,i){if(0===r)return setImmediate((function(){i(null,k(0))}));e.read(t,n,r,o,(function(e,t){return e?i(e):t<r?i(new Error("unexpected EOF")):void i()}))}function v(e){l.call(this),this.actualByteCount=0,this.expectedByteCount=e}function b(){a.call(this),this.refCount=0}function x(e){u.call(this),this.context=e,this.context.ref(),this.unreffedYet=!1}t.open=function(e,t,n){"function"==typeof t&&(n=t,t=null);null==t&&(t={});null==t.autoClose&&(t.autoClose=!0);null==t.lazyEntries&&(t.lazyEntries=!1);null==t.decodeStrings&&(t.decodeStrings=!0);null==t.validateEntrySizes&&(t.validateEntrySizes=!0);null==t.strictFileNames&&(t.strictFileNames=!1);null==n&&(n=I);r.open(e,"r",(function(e,o){if(e)return n(e);d(o,t,(function(e,t){e&&r.close(o,I),n(e,t)}))}))},t.fromFd=d,t.fromBuffer=function(e,t,n){"function"==typeof t&&(n=t,t=null);null==t&&(t={});t.autoClose=!1,null==t.lazyEntries&&(t.lazyEntries=!1);null==t.decodeStrings&&(t.decodeStrings=!0);null==t.validateEntrySizes&&(t.validateEntrySizes=!0);null==t.strictFileNames&&(t.strictFileNames=!1);p(i.createFromBuffer(e,{maxChunkSize:65536}),e.length,t,n)},t.fromRandomAccessReader=p,t.dosDateTimeToDate=g,t.validateFileName=E,t.ZipFile=y,t.Entry=S,t.RandomAccessReader=b,c.inherits(y,a),y.prototype.close=function(){this.isOpen&&(this.isOpen=!1,this.reader.unref())},y.prototype.readEntry=function(){if(!this.lazyEntries)throw new Error("readEntry() called without lazyEntries:true");this._readEntry()},y.prototype._readEntry=function(){var e=this;if(e.entryCount!==e.entriesRead){if(!e.emittedError){var t=k(46);w(e.reader,t,0,t.length,e.readEntryCursor,(function(n){if(n)return h(e,n);if(!e.emittedError){var r=new S,o=t.readUInt32LE(0);if(33639248!==o)return h(e,new Error("invalid central directory file header signature: 0x"+o.toString(16)));if(r.versionMadeBy=t.readUInt16LE(4),r.versionNeededToExtract=t.readUInt16LE(6),r.generalPurposeBitFlag=t.readUInt16LE(8),r.compressionMethod=t.readUInt16LE(10),r.lastModFileTime=t.readUInt16LE(12),r.lastModFileDate=t.readUInt16LE(14),r.crc32=t.readUInt32LE(16),r.compressedSize=t.readUInt32LE(20),r.uncompressedSize=t.readUInt32LE(24),r.fileNameLength=t.readUInt16LE(28),r.extraFieldLength=t.readUInt16LE(30),r.fileCommentLength=t.readUInt16LE(32),r.internalFileAttributes=t.readUInt16LE(36),r.externalFileAttributes=t.readUInt32LE(38),r.relativeOffsetOfLocalHeader=t.readUInt32LE(42),64&r.generalPurposeBitFlag)return h(e,new Error("strong encryption is not supported"));e.readEntryCursor+=46,t=k(r.fileNameLength+r.extraFieldLength+r.fileCommentLength),w(e.reader,t,0,t.length,e.readEntryCursor,(function(n){if(n)return h(e,n);if(!e.emittedError){var o=0!=(2048&r.generalPurposeBitFlag);r.fileName=e.decodeStrings?O(t,0,r.fileNameLength,o):t.slice(0,r.fileNameLength);var i=r.fileNameLength+r.extraFieldLength,c=t.slice(r.fileNameLength,i);r.extraFields=[];for(var a=0;a<c.length-3;){var l=c.readUInt16LE(a+0),u=c.readUInt16LE(a+2),f=a+4,d=f+u;if(d>c.length)return h(e,new Error("extra field length exceeds extra field buffer size"));var p=k(u);c.copy(p,0,f,d),r.extraFields.push({id:l,data:p}),a=d}if(r.fileComment=e.decodeStrings?O(t,i,i+r.fileCommentLength,o):t.slice(i,i+r.fileCommentLength),r.comment=r.fileComment,e.readEntryCursor+=t.length,e.entriesRead+=1,4294967295===r.uncompressedSize||4294967295===r.compressedSize||4294967295===r.relativeOffsetOfLocalHeader){var y=null;for(a=0;a<r.extraFields.length;a++){if(1===(S=r.extraFields[a]).id){y=S.data;break}}if(null==y)return h(e,new Error("expected zip64 extended information extra field"));var m=0;if(4294967295===r.uncompressedSize){if(m+8>y.length)return h(e,new Error("zip64 extended information extra field does not include uncompressed size"));r.uncompressedSize=N(y,m),m+=8}if(4294967295===r.compressedSize){if(m+8>y.length)return h(e,new Error("zip64 extended information extra field does not include compressed size"));r.compressedSize=N(y,m),m+=8}if(4294967295===r.relativeOffsetOfLocalHeader){if(m+8>y.length)return h(e,new Error("zip64 extended information extra field does not include relative header offset"));r.relativeOffsetOfLocalHeader=N(y,m),m+=8}}if(e.decodeStrings)for(a=0;a<r.extraFields.length;a++){var S;if(28789===(S=r.extraFields[a]).id){if(S.data.length<6)continue;if(1!==S.data.readUInt8(0))continue;var g=S.data.readUInt32LE(1);if(s.unsigned(t.slice(0,r.fileNameLength))!==g)continue;r.fileName=O(S.data,5,S.data.length,!0);break}}if(e.validateEntrySizes&&0===r.compressionMethod){var w=r.uncompressedSize;if(r.isEncrypted()&&(w+=12),r.compressedSize!==w){var v="compressed/uncompressed size mismatch for stored file: "+r.compressedSize+" != "+r.uncompressedSize;return h(e,new Error(v))}}if(e.decodeStrings){e.strictFileNames||(r.fileName=r.fileName.replace(/\\/g,"/"));var b=E(r.fileName,e.validateFileNameOptions);if(null!=b)return h(e,new Error(b))}e.emit("entry",r),e.lazyEntries||e._readEntry()}}))}}))}}else setImmediate((function(){e.autoClose&&e.close(),e.emittedError||e.emit("end")}))},y.prototype.openReadStream=function(e,t,n){var r=this,i=0,s=e.compressedSize;if(null==n)n=t,t={};else{if(null!=t.decrypt){if(!e.isEncrypted())throw new Error("options.decrypt can only be specified for encrypted entries");if(!1!==t.decrypt)throw new Error("invalid options.decrypt value: "+t.decrypt);if(e.isCompressed()&&!1!==t.decompress)throw new Error("entry is encrypted and compressed, and options.decompress !== false")}if(null!=t.decompress){if(!e.isCompressed())throw new Error("options.decompress can only be specified for compressed entries");if(!1!==t.decompress&&!0!==t.decompress)throw new Error("invalid options.decompress value: "+t.decompress)}if(null!=t.start||null!=t.end){if(e.isCompressed()&&!1!==t.decompress)throw new Error("start/end range not allowed for compressed entry without options.decompress === false");if(e.isEncrypted()&&!1!==t.decrypt)throw new Error("start/end range not allowed for encrypted entry without options.decrypt === false")}if(null!=t.start){if((i=t.start)<0)throw new Error("options.start < 0");if(i>e.compressedSize)throw new Error("options.start > entry.compressedSize")}if(null!=t.end){if((s=t.end)<0)throw new Error("options.end < 0");if(s>e.compressedSize)throw new Error("options.end > entry.compressedSize");if(s<i)throw new Error("options.end < options.start")}}if(!r.isOpen)return n(new Error("closed"));if(e.isEncrypted()&&!1!==t.decrypt)return n(new Error("entry is encrypted, and options.decrypt !== false"));r.reader.ref();var c=k(30);w(r.reader,c,0,c.length,e.relativeOffsetOfLocalHeader,(function(a){try{if(a)return n(a);var l=c.readUInt32LE(0);if(67324752!==l)return n(new Error("invalid local file header signature: 0x"+l.toString(16)));var u,f=c.readUInt16LE(26),d=c.readUInt16LE(28),p=e.relativeOffsetOfLocalHeader+c.length+f+d;if(0===e.compressionMethod)u=!1;else{if(8!==e.compressionMethod)return n(new Error("unsupported compression method: "+e.compressionMethod));u=null==t.decompress||t.decompress}var y=p,h=y+e.compressedSize;if(0!==e.compressedSize&&h>r.fileSize)return n(new Error("file data overflows file bounds: "+y+" + "+e.compressedSize+" > "+r.fileSize));var m=r.reader.createReadStream({start:y+i,end:y+s}),S=m;if(u){var g=!1,E=o.createInflateRaw();m.on("error",(function(e){setImmediate((function(){g||E.emit("error",e)}))})),m.pipe(E),r.validateEntrySizes?(S=new v(e.uncompressedSize),E.on("error",(function(e){setImmediate((function(){g||S.emit("error",e)}))})),E.pipe(S)):S=E,S.destroy=function(){g=!0,E!==S&&E.unpipe(S),m.unpipe(E),m.destroy()}}n(null,S)}finally{r.reader.unref()}}))},S.prototype.getLastModDate=function(){return g(this.lastModFileDate,this.lastModFileTime)},S.prototype.isEncrypted=function(){return 0!=(1&this.generalPurposeBitFlag)},S.prototype.isCompressed=function(){return 8===this.compressionMethod},c.inherits(v,l),v.prototype._transform=function(e,t,n){if(this.actualByteCount+=e.length,this.actualByteCount>this.expectedByteCount){var r="too many bytes in the stream. expected "+this.expectedByteCount+". got at least "+this.actualByteCount;return n(new Error(r))}n(null,e)},v.prototype._flush=function(e){if(this.actualByteCount<this.expectedByteCount){var t="not enough bytes in the stream. expected "+this.expectedByteCount+". got only "+this.actualByteCount;return e(new Error(t))}e()},c.inherits(b,a),b.prototype.ref=function(){this.refCount+=1},b.prototype.unref=function(){var e=this;if(e.refCount-=1,!(e.refCount>0)){if(e.refCount<0)throw new Error("invalid unref");e.close((function(t){if(t)return e.emit("error",t);e.emit("close")}))}},b.prototype.createReadStream=function(e){var t=e.start,n=e.end;if(t===n){var r=new u;return setImmediate((function(){r.end()})),r}var o=this._readStreamForRange(t,n),i=!1,s=new x(this);o.on("error",(function(e){setImmediate((function(){i||s.emit("error",e)}))})),s.destroy=function(){o.unpipe(s),s.unref(),o.destroy()};var c=new v(n-t);return s.on("error",(function(e){setImmediate((function(){i||c.emit("error",e)}))})),c.destroy=function(){i=!0,s.unpipe(c),s.destroy()},o.pipe(s).pipe(c)},b.prototype._readStreamForRange=function(e,t){throw new Error("not implemented")},b.prototype.read=function(e,t,n,r,o){var i=this.createReadStream({start:r,end:r+n}),s=new f,c=0;s._write=function(n,r,o){n.copy(e,t+c,0,n.length),c+=n.length,o()},s.on("finish",o),i.on("error",(function(e){o(e)})),i.pipe(s)},b.prototype.close=function(e){setImmediate(e)},c.inherits(x,u),x.prototype._flush=function(e){this.unref(),e()},x.prototype.unref=function(e){this.unreffedYet||(this.unreffedYet=!0,this.context.unref())};var k,j="\0☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ";function O(e,t,n,r){if(r)return e.toString("utf8",t,n);for(var o="",i=t;i<n;i++)o+=j[e[i]];return o}function N(e,t){var n=e.readUInt32LE(t);return 4294967296*e.readUInt32LE(t+4)+n}function I(e){if(e)throw e}k="function"==typeof Buffer.allocUnsafe?function(e){return Buffer.allocUnsafe(e)}:function(e){return new Buffer(e)}},function(e,t){e.exports=require("zlib")},function(e,t,n){var r=n(5),o=n(10),i=n(6),s=i.Readable,c=i.Writable,a=i.PassThrough,l=n(52),u=n(20).EventEmitter;function f(e,t){t=t||{},u.call(this),this.fd=e,this.pend=new l,this.pend.max=1,this.refCount=0,this.autoClose=!!t.autoClose}function d(e,t){t=t||{},s.call(this,t),this.context=e,this.context.ref(),this.start=t.start||0,this.endOffset=t.end,this.pos=this.start,this.destroyed=!1}function p(e,t){t=t||{},c.call(this,t),this.context=e,this.context.ref(),this.start=t.start||0,this.endOffset=null==t.end?1/0:+t.end,this.bytesWritten=0,this.pos=this.start,this.destroyed=!1,this.on("finish",this.destroy.bind(this))}function y(e,t){u.call(this),t=t||{},this.refCount=0,this.buffer=e,this.maxChunkSize=t.maxChunkSize||Number.MAX_SAFE_INTEGER}t.createFromBuffer=function(e,t){return new y(e,t)},t.createFromFd=function(e,t){return new f(e,t)},t.BufferSlicer=y,t.FdSlicer=f,o.inherits(f,u),f.prototype.read=function(e,t,n,o,i){var s=this;s.pend.go((function(c){r.read(s.fd,e,t,n,o,(function(e,t,n){c(),i(e,t,n)}))}))},f.prototype.write=function(e,t,n,o,i){var s=this;s.pend.go((function(c){r.write(s.fd,e,t,n,o,(function(e,t,n){c(),i(e,t,n)}))}))},f.prototype.createReadStream=function(e){return new d(this,e)},f.prototype.createWriteStream=function(e){return new p(this,e)},f.prototype.ref=function(){this.refCount+=1},f.prototype.unref=function(){var e=this;if(e.refCount-=1,!(e.refCount>0)){if(e.refCount<0)throw new Error("invalid unref");e.autoClose&&r.close(e.fd,(function(t){t?e.emit("error",t):e.emit("close")}))}},o.inherits(d,s),d.prototype._read=function(e){var t=this;if(!t.destroyed){var n=Math.min(t._readableState.highWaterMark,e);if(null!=t.endOffset&&(n=Math.min(n,t.endOffset-t.pos)),n<=0)return t.destroyed=!0,t.push(null),void t.context.unref();t.context.pend.go((function(e){if(t.destroyed)return e();var o=new Buffer(n);r.read(t.context.fd,o,0,n,t.pos,(function(n,r){n?t.destroy(n):0===r?(t.destroyed=!0,t.push(null),t.context.unref()):(t.pos+=r,t.push(o.slice(0,r))),e()}))}))}},d.prototype.destroy=function(e){this.destroyed||(e=e||new Error("stream destroyed"),this.destroyed=!0,this.emit("error",e),this.context.unref())},o.inherits(p,c),p.prototype._write=function(e,t,n){var o=this;if(!o.destroyed){if(o.pos+e.length>o.endOffset){var i=new Error("maximum file length exceeded");return i.code="ETOOBIG",o.destroy(),void n(i)}o.context.pend.go((function(t){if(o.destroyed)return t();r.write(o.context.fd,e,0,e.length,o.pos,(function(e,r){e?(o.destroy(),t(),n(e)):(o.bytesWritten+=r,o.pos+=r,o.emit("progress"),t(),n())}))}))}},p.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.context.unref())},o.inherits(y,u),y.prototype.read=function(e,t,n,r,o){var i=r+n,s=i-this.buffer.length,c=s>0?s:n;this.buffer.copy(e,t,r,i),setImmediate((function(){o(null,c)}))},y.prototype.write=function(e,t,n,r,o){e.copy(this.buffer,r,t,t+n),setImmediate((function(){o(null,n,e)}))},y.prototype.createReadStream=function(e){var t=new a(e=e||{});t.destroyed=!1,t.start=e.start||0,t.endOffset=e.end,t.pos=t.endOffset||this.buffer.length;for(var n=this.buffer.slice(t.start,t.pos),r=0;;){var o=r+this.maxChunkSize;if(o>=n.length){r<n.length&&t.write(n.slice(r,n.length));break}t.write(n.slice(r,o)),r=o}return t.end(),t.destroy=function(){t.destroyed=!0},t},y.prototype.createWriteStream=function(e){var t=this,n=new c(e=e||{});return n.start=e.start||0,n.endOffset=null==e.end?this.buffer.length:+e.end,n.bytesWritten=0,n.pos=n.start,n.destroyed=!1,n._write=function(e,r,o){if(!n.destroyed){var i=n.pos+e.length;if(i>n.endOffset){var s=new Error("maximum file length exceeded");return s.code="ETOOBIG",n.destroyed=!0,void o(s)}e.copy(t.buffer,n.pos,0,e.length),n.bytesWritten+=e.length,n.pos=i,n.emit("progress"),o()}},n.destroy=function(){n.destroyed=!0},n},y.prototype.ref=function(){this.refCount+=1},y.prototype.unref=function(){if(this.refCount-=1,this.refCount<0)throw new Error("invalid unref")}},function(e,t){function n(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}function r(e){e.pending+=1;var t=!1;return function(r){if(t)throw new Error("callback called twice");if(t=!0,e.error=e.error||r,e.pending-=1,e.waiting.length>0&&e.pending<e.max)o(e,e.waiting.shift());else if(0===e.pending){var i=e.listeners;e.listeners=[],i.forEach(n)}};function n(t){t(e.error)}}function o(e,t){t(r(e))}e.exports=n,n.prototype.go=function(e){this.pending<this.max?o(this,e):this.waiting.push(e)},n.prototype.wait=function(e){0===this.pending?e(this.error):this.listeners.push(e)},n.prototype.hold=function(){return r(this)}},function(e,t,n){var r=n(54).Buffer,o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];function i(e){if(r.isBuffer(e))return e;var t="function"==typeof r.alloc&&"function"==typeof r.from;if("number"==typeof e)return t?r.alloc(e):new r(e);if("string"==typeof e)return t?r.from(e):new r(e);throw new Error("input must be buffer, number, or string, received "+typeof e)}function s(e,t){e=i(e),r.isBuffer(t)&&(t=t.readUInt32BE(0));for(var n=-1^~~t,s=0;s<e.length;s++)n=o[255&(n^e[s])]^n>>>8;return-1^n}function c(){return e=s.apply(null,arguments),(t=i(4)).writeInt32BE(e,0),t;var e,t}"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),c.signed=function(){return s.apply(null,arguments)},c.unsigned=function(){return s.apply(null,arguments)>>>0},e.exports=c},function(e,t){e.exports=require("buffer")},function(e,t,n){const r=n(56);let o;e.exports=class e{static getInstance(){return o||(o=new e),o}constructor(){this._process=new Map}exec(e,t,n){this._nextId++;let o=e.shift(),i=t.tag;delete t.tag,t.shell=!0;let s=r.spawn(o,e,t);console.log(`[CLI] spawn (${s.pid}): ${o} ${e.join(" ")}`);let c=this._process;c.set(i,s);let a=[],l=[];s.stdout.on("data",e=>{a.push(e),"object"==typeof n&&n.stdout(e)}),s.stderr.on("data",e=>{l.push(e),"object"==typeof n&&n.stderr(e)}),s.on("error",e=>{c.has(i)&&c.delete(i),"object"==typeof n?n.error(e,a.join(""),l.join("")):"function"==typeof n&&n(e,a.join(""),l.join(""))}),s.on("exit",(e,t)=>{t=t||"",console.log(`[CLI] exit (${s.pid}) ${e} ${t}`),c.has(i)&&c.delete(i),"object"==typeof n?n.exit(a.join(""),l.join("")):"function"==typeof n&&n(null,a.join(""),l.join(""))})}kill(e){if(this._process.has(e)){let t=this._process[e];t&&t.kill(),this._process.delete(e)}}query(e){return this._process.has(e)}}},function(e,t){e.exports=require("child_process")},function(e,t,n){"use strict";var r=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===o}(e)}(e)};var o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?l((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function s(e,t,n){return e.concat(t).map((function(e){return i(e,n)}))}function c(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function a(e,t,n){var r={};return n.isMergeableObject(e)&&c(e).forEach((function(t){r[t]=i(e[t],n)})),c(t).forEach((function(o){n.isMergeableObject(t[o])&&e[o]?r[o]=function(e,t){if(!t.customMerge)return l;var n=t.customMerge(e);return"function"==typeof n?n:l}(o,n)(e[o],t[o],n):r[o]=i(t[o],n)})),r}function l(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||s,n.isMergeableObject=n.isMergeableObject||r,n.cloneUnlessOtherwiseSpecified=i;var o=Array.isArray(t);return o===Array.isArray(e)?o?n.arrayMerge(e,t,n):a(e,t,n):i(t,n)}l.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return l(e,n,t)}),{})};var u=l;e.exports=u},function(e,t,n){"use strict";n.r(t);let r={version:"1.4.1",beta:!1};n.d(t,"launch",(function(){return S})),n.d(t,"sendMsgToSBWin",(function(){return E})),n.d(t,"handleEvent",(function(){return g})),n.d(t,"load",(function(){return h})),n.d(t,"unload",(function(){return m})),n.d(t,"needUpdate",(function(){return v}));const{app:o,BrowserWindow:i,ipcMain:s,dialog:c}=n(21),a=n(9),l=n(0),u=n(12),f=n(13),d=n(48),p=(l.join(a.homedir(),".sdkbox","conf","gui.json"),l.join(a.homedir(),".sdkbox","creator","data","info.json"));let y;function h(){w({event:"creator_sdkbox_load"}),o.on("will-quit",()=>{w({event:"creator_quit"})}),b()}function m(){w({event:"creator_sdkbox_unload"})}function S(){try{y&&y.show()}catch(e){y=null}if(y)return;const e=d.getProjectRoot();if(null==e)return void Editor.log("Can't get project root path, can't open SDKBox window");if(null==Editor.builtinCocosRoot)return void Editor.log("Editor.builtinCocosRoot is null, can't open SDKBox window");let t,n=null;n||(n={windowPos:{width:1080,height:720}}),(t=new i({width:n.windowPos.width,height:n.windowPos.height,minWidth:960,minHeight:600,webPreferences:{nodeIntegration:!0}})).downloads={};let r=`file://${l.join(__dirname,"..","pages")}/index.html`;return r+=`?project=${encodeURIComponent(e)}&builtinCocosRoot=${encodeURIComponent(Editor.builtinCocosRoot)}`,t.loadURL(r),w({event:"session_start"}),s.on("open-file-dialog",(function(e){let t=c.showOpenDialog({properties:["openDirectory"]});e.sender.send("selected-directory",t)})),s.on("download-file",(function(e,n){null!=t?t.webContents.downloadURL(n):console.log("Win is null")})),s.on("cancel-download-file",(function(e,n){let r=t.downloads[n];r?(r.cancel(),delete t.downloads[n]):console.log("failed, can not find download item by url")})),t.on("close",()=>{y=null,w({event:"session_end"});for(let e in t.downloads)t.downloads[e].cancel()}),t.on("closed",()=>{t=null}),t.webContents.session.on("will-download",(e,t,n)=>{let r=y;const o=t.getURL(),i=o.split("/"),s=l.join(a.homedir(),".sdkbox","temp",i[i.length-1]);t.setSavePath(s),r.downloads[o]=t,t.on("updated",(e,n)=>{let i={state:n,url:o};"interrupted"===n&&delete r.downloads[o],"progressing"===n&&(i.downloadRatio=100*t.getReceivedBytes()/t.getTotalBytes()),r.webContents.send("download-status",i)}),t.once("done",(e,t)=>{r&&(delete r.downloads[o],r.webContents.send("download-finish",{state:t,url:o}))})}),y=t,t}function g(e,t,n){if("android"!=n.platform&&"ios"!=n.platform)return;const r=d.getProjectRoot();switch(e){case"SDKBox:import-query":1===Editor.Dialog.messageBox({type:"info",buttons:[Editor.T("MESSAGE.cancel"),Editor.T("MESSAGE.yes")],title:"SDKBox",message:"Install SDKBox Plugin?"})&&Editor.Ipc.sendToMain("sdkbox:launch");break;case"SDKBox:build-start":if(r){let e=l.normalize(l.join(n.dest,"res","sdkbox_config.json"));if(f.existsSync(e)||(e=l.normalize(l.join(n.dest,"assets","sdkbox_config.json"))),f.existsSync(e))try{f.copySync(e,l.normalize(l.join(r,"temp","SDKBox","sdkbox_config.json"))),Editor.log("SDKBox: backup sdkbox_config.json successfully")}catch(e){Editor.log(`SDKBox: backup sdkbox_config.json failed: ${e}`)}if(e=l.normalize(l.join(n.dest,"res","sdkboxgpg.js")),f.existsSync(e)||(e=l.normalize(l.join(n.dest,"assets","sdkboxgpg.json"))),f.existsSync(e))try{f.copySync(e,l.normalize(l.join(r,"temp","SDKBox","sdkboxgpg.js"))),Editor.log("SDKBox: backup sdkboxgpg.js successfully")}catch(e){Editor.log(`SDKBox: backup sdkboxgpg.js failed: ${e}`)}}break;case"SDKBox:build-finish":if(r){let e=l.normalize(l.join(r,"temp","SDKBox","sdkbox_config.json")),t=l.normalize(l.join(n.dest,"res"));f.existsSync(t)||(t=l.normalize(l.join(n.dest,"assets"))),f.existsSync(e)&&f.copy(e,l.normalize(l.join(t,"sdkbox_config.json")),(function(e){e?Editor.log(`SDKBox: write sdkbox_config.json failed: ${e}`):Editor.log("SDKBox: write sdkbox_config.json successfully")})),e=l.normalize(l.join(r,"temp","SDKBox","sdkboxgpg.js")),f.existsSync(e)&&f.copy(e,l.normalize(l.join(t,"sdkboxgpg.js")),(function(e){e?Editor.log(`SDKBox: write sdkboxgpg.js failed: ${e}`):Editor.log("SDKBox: write sdkboxgpg.js successfully")}))}E(e)}}function E(e,t){null!=y&&null!=y.webContents&&void 0!==e&&y.webContents.send(e,t)}function w(e){e.chanel="creator","undefined"!=typeof Editor&&(e.userName=Editor.lastLogin,e.creatorVersion=Editor.App.version),e.version=r.version,e.beta=r.beta;const t=`http://metrics.sdkbox.com/?${JSON.stringify(e)}`;var n;n=t,u.get(n,e=>{}).on("error",(function(){}))}function v(){const e=f.readJsonSync(p,{throws:!1});if(null==e)return!0;let t=!0;try{d.compareVersions(e.version.installer.local,e.version.installer.remote)>=0&&d.compareVersions(e.version.gui.local,e.version.gui.remote)>=0&&(t=!1)}catch(e){t=!0}return t||b(),t}function b(){f.pathExists(p).then(e=>{if(e)f.readJson(p).then(e=>{try{const t=e.fetchTime,n=Date.parse(new Date);(void 0===t||n-t>864e5)&&(e.fetchTime=n,f.writeJson(p,e),d.loadRemoteVersions())}catch(e){Editor.log(e)}}).catch(e=>{console.error(e)});else{ct=Date.parse(new Date);const e={fetchTime:ct};f.writeJson(p,e),d.loadRemoteVersions()}}).catch(e=>{console.log(e)})}}])}));